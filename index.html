<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <title>Riverdale BRT</title>
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
  <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11"/>
  <script src="https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js"></script>
  <link href="https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.css" rel="stylesheet" />
  <style>
  </style>
</head>

<body>
  <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.5.1/mapbox-gl-geocoder.min.js"></script>
  <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.5.1/mapbox-gl-geocoder.css" type="text/css" />
  <!-- Promise polyfill script required to use Mapbox GL Geocoder in IE 11 -->
  <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.min.js"></script>
  <script src="https://cdn.polyfill.io/v2/polyfill.min.js"></script>

  <style>
    body {
      margin: 0;
      padding: 0;
    }

    #map {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 100%;
    }

    img {
      max-width: 150px;
    }

    .geocoder-dropdown-item {
      padding: 5px;
    }

    .geocoder-dropdown-icon {
      margin-right: 10px;
    }

    .geocoder-dropdown-text {
      color: #5a3fc0;
      font-family: Arial, Helvetica, sans-serif;
      font-size: larger;
    }

    .mapboxgl-popup {
      max-width: 300px;
      min-width: 200px;
      max-height: 300px;
      font: 14px/20px "Helvetica Neue", Arial, Helvetica, sans-serif;
      overflow-y: scroll;
      overflow-x: scroll;
      overflow: scroll;
      z-index: 10;
      border: 0px solid rgba(0, 79, 150, 0.9);
      margin: 19px 20px;
    }
    h2 {
      color: "#088ccc !important";
    }
    .mapboxgl-popup-content {
      overflow: scroll;
      background-color: rgba(250, 250, 250, 0.8);
      font: 14px/20px "Helvetica Neue", Arial, Helvetica, sans-serif;
      color: #2f3234;

    }
    a {
      color: #f47521;
    }
    .leftPop {
      float: left;
      width: 50%;
    }

    .rightPop {
      float: right;
      width: 50%;
    }

    .mapboxgl-ctrl-geocoder {
      min-width: 285px;
    }

    #menu {
      background: #fff;
      position: relative;
      z-index: 3;
      top: 0px;
      left: 25px;
      bottom: 20px;
      border-radius: 3px;
      width: 75%;
      border: 1px solid rgba(0, 0, 0, 0.4);
      font-family: 'Roboto', sans-serif;
      margin-bottom: 20px;
    }

    #menu a {
      font-size: 13px;
      color: #404040;
      display: block;
      margin: 0;
      padding: 0;
      padding: 10px;
      text-decoration: none;
      border-bottom: 1px solid rgba(0, 0, 0, 0.25);
      text-align: center;
    }
    #menu a.1 {
      background-color: yellow;
    }

    #menu a:last-child {
      border: none;
    }

    #menu a:hover {
      background-color: #f8f8f8;
      color: #404040;
    }

    #menu a.active {
      background-color: #088ccc;
      color: #ffffff;
    }

    #menu a.active:hover {
      background: #ffb500;
    }
    #menu-container {
      background: rgba(0, 0, 0, 0.5);
      position: absolute;
      z-index: 1;
      top: 10px;
      left: 20px;
      border-top: 20px;
      border-radius: 3px;
      width: 220px;
      border: 1px solid rgba(0, 0, 0, 0.0);
      font-family: 'Helvetica', sans-serif;
      color: white;
    }
    #feature-filter {
      background: rgba(255, 255, 255, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1;
      top: 40px;
      /* left: 40px; */
      border-top: 20px;
      border-radius: 3px;
      min-height: 30px;
      /* width: 220px; */
      border: 1px solid rgba(255, 255, 255, 0.5);
      font-family: 'Helvetica', sans-serif;
      color: white;
    }
    #sideNav  {
      -webkit-column-width: 240px;
      -moz-column-width: 240px;
      column-width: 240px;
      width: 260px;
      border-color: red;
      display: flex;
      -webkit-flex-direction: column;
      -ms-flex-direction: column;
      flex-direction: column;
      justify-content: flex-start;
    }
    fieldset {
      border-width: 0px;
    }
    /* Rounded border */
hr.rounded {
  border-top: 8px solid #bbb;
  border-radius: 5px;
}

  </style>
  <!-- <div class="nav">
    <h2>ATL Disrticts Map</h2>
  </div> -->

  <div id="map-container">
    <div id="map">
    <div id="sideNav">
    <div id="menu-container">
      <h3 style="padding: 0 25px">Use the buttons below to menu the layers on and off</h3>
       <nav id="menu"> </nav>
      <!-- <h3 style="padding: 0 10px">Filter by Project Sponsor</h3>
       <fieldset>
        <input
        id="feature-filter"
        style="padding: 0 10px"
        type="text"
        placeholder="Enter a Project Sponsor"
        />
        </fieldset>
        <div id="feature-listing" class="listing"></div> -->
    </div>
    </div>
  </div>
</div>

  <!-- <div class="footer">

  </div> -->
  <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoibGNhY2VkYSIsImEiOiIzNmM4MGRlN2I4NDhiY2UxZjA4MmJjZjE5OWEzYjUzNSJ9.Wc5KTJpWxmpxVMZfcuEQNg';

    var layerIDs = []; // Will contain a list used to filter against.
    var filterInput = document.getElementById('feature-filter');
    var map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/streets-v11',
      // style: 'mapbox://styles/mapbox/streets-v9',
      center: [-84.352843, 33.604339],
      zoom: 10.5
    });

    var projectSponsors = [];
    var filterEl = document.getElementById('feature-filter');
    var listinEl = document.getElementById('feature-listing');

    //<!--MARTA GOLD LINE-- >
    map.on('load', function() {
      map.addSource('Existing MARTA Gold Line', {
        'type': 'geojson',
        'data': 'data/MARTA_GoldLine.geojson'
      });

      //Add polygon LAYER
      map.addLayer({
        'id': 'Existing MARTA Gold Line',
        'type': 'line',
        'source': 'Existing MARTA Gold Line',
        'layout': {
          'visibility': 'visible',
          'line-join': 'round',
          'line-cap': 'round'
        },
        'paint': {
          'line-color': 'rgba(251, 178, 23, 1)',
          'line-width': 2
        }
      });
    });

    //<!--MARTA RED LINE-- >
    map.on('load', function() {
      map.addSource('Existing MARTA Red Line', {
        'type': 'geojson',
        'data': 'data/MARTA_RedLine.geojson'
      });

      //Add polygon LAYER
      map.addLayer({
        'id': 'Existing MARTA Red Line',
        'type': 'line',
        'source': 'Existing MARTA Red Line',
        'layout': {
          'visibility': 'visible',
          'line-join': 'round',
          'line-cap': 'round'
        },
        'paint': {
          'line-color': 'rgba(255, 0, 0, 1)',
          'line-width': 2
        }
      });
    });


// <!--Clayton Commuter Rail LAYER-- >
  map.on('load', function() {
    map.addSource('Clayton Commuter Rail', {
      'type': 'geojson',
      'data': 'data/ClaytonCommuterRail.geojson'
    });

    //Add polygon LAYER
    map.addLayer({
      'id': 'Clayton Commuter Rail',
      'type': 'line',
      'source': 'Clayton Commuter Rail',
      'layout': {
        'visibility': 'visible',
        'line-join': 'round',
        'line-cap': 'round'
      },
      'paint': {
        'line-color': 'rgba(55, 180, 180, 1)',
        'line-width': 2
      }
    });
  });


// <!--Other LINES LAYER-- >
      map.on('load', function() {
        map.addSource('Existing Clayton Bus Routes', {
          'type': 'geojson',
          'data': 'data/ClaytonBusRoutes_Existing.geojson'
        });

        //Add Lines LAYER
        map.addLayer({
          'id': 'Existing Clayton Bus Routes',
          'type': 'line',
          'source': 'Existing Clayton Bus Routes',
          'layout': {
            'visibility': 'none',
            'line-join': 'round',
            'line-cap': 'round'
          },
          'paint': {
            // 'line-color': 'rgba(134,134,134,0.8)',
            'line-color': ['get', 'Color'],
            'line-width': 2,
            'line-opacity': 1,
            // 'line-outline-color': 'rgba(0, 0, 0, 1)'
            // 'line-color': {
            //   'property': 'color',
            //   'type': 'identity'
            // },
            // 'line-offset': {
            //   'property': 'Color',
            //   'type': 'categorical',
            //   stops: [
            //     [1, 0],
            //     [2, 3],
            //     [3, 6]
            //   ]
            // }
          }
        });
      });


// <!--RiverdaleBRT_Phase2-- >
          map.on('load', function() {
            map.addSource('Riverdale BRT 2', {
              'type': 'geojson',
              'data': 'data/RiverdaleBRT_Phase2.geojson'
            });

            //Add polygon LAYER
            map.addLayer({
              'id': 'Riverdale BRT Phase 2',
              'type': 'line',
              'source': 'Riverdale BRT 2',
              'layout': {
                'visibility': 'visible',
                'line-join': 'round',
                'line-cap': 'round'
              },
              'paint': {
                'line-color': 'rgba(3, 93, 130, 1)',
                'line-width': 4
              }
            });
          });
// <!--RiverdaleBRT_Phase1-- >
          map.on('load', function() {
            map.addSource('Riverdale BRT 1', {
              'type': 'geojson',
              'data': 'data/RiverdaleBRT_Phase1.geojson'
            });

            //Add polygon LAYER
            map.addLayer({
              'id': 'Riverdale BRT Phase 1',
              'type': 'line',
              'source': 'Riverdale BRT 1',
              'layout': {
                'visibility': 'visible',
                'line-join': 'round',
                'line-cap': 'round'
              },
              'paint': {
                'line-color': 'rgba(80, 200, 251, 1)',
                'line-width': 4
              }
            });
          });

// <!--POINTS LAYERS-- >
    map.on('load', function() {
      map.addSource('17 Stations', {
        'type': 'geojson',
        'data': 'data/Riverdale_Stations_17.geojson'
      });

//Add POINTS LAYER
      map.addLayer({
        'id': 'Riverdale Stations',
        'type': 'circle',
        'source': '17 Stations',
        'layout': {
          'visibility': 'visible'
          // 'line-join': 'round',
          // 'line-cap': 'round'
        },
        'paint': {
          'circle-color': 'rgba(253, 183, 20, .8)',
          'circle-stroke-color': 'rgba(253, 183, 20, 1)',
          'circle-stroke-opacity': 1,
          'circle-stroke-width': 2,
          'circle-radius': 7.5
        }
      });
    });

// <!--POINTS LAYERS-- >
    map.on('load', function() {
      map.addSource('Riverdale Major Stations', {
        'type': 'geojson',
        'data': 'data/RiverdaleBRT_MajorStations.geojson'
      });

//Add POINTS LAYER
      map.addLayer({
        'id': 'Riverdale Major Stations',
        'type': 'circle',
        'source': 'Riverdale Major Stations',
        'layout': {
          'visibility': 'visible'
          // 'line-join': 'round',
          // 'line-cap': 'round'
        },
        'paint': {
          'circle-color': 'rgba(75, 75, 75, .8)',
          'circle-stroke-color': 'rgba(250, 250, 250, 1)',
          'circle-stroke-opacity': 1,
          'circle-stroke-width': 2,
          'circle-radius': 9
        }
      });
    });

    map.addControl(
      new MapboxGeocoder({
        accessToken: mapboxgl.accessToken,
        zoom: 11,
        placeholder: 'Search for an address or place',
        mapboxgl: mapboxgl
      })
    );
    // Add zoom and rotation controls to the map.
    map.addControl(new mapboxgl.NavigationControl());
    // Add full screen control to the map.
    map.addControl(new mapboxgl.FullscreenControl());

    // enumerate ids of the layers
    var toggleableLayerIds = [ 'Existing MARTA Red Line', 'Existing MARTA Gold Line', 'Clayton Commuter Rail', 'Existing Clayton Bus Routes','Riverdale BRT Phase 1', 'Riverdale BRT Phase 2', 'Riverdale Stations', 'Riverdale Major Stations','More layers coming soon'];


// set up the corresponding toggle button for each layer
    for (var i = 0; i < toggleableLayerIds.length; i++) {
      var id=toggleableLayerIds[i];
      var link=document.createElement('a'); link.href='#' ; link.className='active' ;
      link.textContent=id;

      link.onclick=function (e) {
        var clickedLayer=this.textContent;
        e.preventDefault(); e.stopPropagation();


        var visibility=map.getLayoutProperty(clickedLayer, 'visibility' );
// toggle layer visibility by changing the layout object's visibility property
        if (visibility==='visible' ) {
          map.setLayoutProperty(clickedLayer, 'visibility' , 'none' );
            this.className='' ; }
            else {
              this.className='active' ;
              map.setLayoutProperty(clickedLayer, 'visibility' , 'visible');
            } };
            var layers=document.getElementById('menu'); layers.appendChild(link); }



// ********** PopUps for POINTS Stations Layer **********
      map.on('click', 'Riverdale Stations', function(e) {
            new mapboxgl.Popup()
            .setLngLat(e.lngLat)
            .setHTML(
              "<h2>Riverdale Station</h2>"+ "<hr />"
              +"<strong>STOP NAME: </strong>" + "<br />"
              + e.features[0].properties.stop_name + "<br />")
            .addTo(map);
            // listingEl.appendChild(item);

         });

// ********** PopUps for POINTS Mobility Hubs Layer **********
   map.on('click', 'Riverdale Major Stations', function(e) {
         new mapboxgl.Popup()
         .setLngLat(e.lngLat)
         .setHTML(
           "<h2>Riverdale Mobility Hub</h2>"+ "<hr />"
           + "<strong>MOBILITY HUB NAME: </strong>"+ "<br />"
           + e.features[0].properties.STATION + "<br />")
         .addTo(map);
         // listingEl.appendChild(item);

      });

//********* Popups for Riverdale Phase 1 Lines Layer ******

    map.on('click', 'Riverdale BRT Phase 1', function(e) {
        new mapboxgl.Popup()
        .setLngLat(e.lngLat)
        .setHTML(
          "<h2>RIVERDALE BRT PHASE 1</h2>"+ "<hr />"
          + "<strong>Line Name: </strong>"+ " " + e.features[0].properties.line_name + "<br />"
          + "<strong>Miles: </strong>" + e.features[0].properties.mi + "<br /> "
          + "<strong>Hours per Year: </strong>" + e.features[0].properties.hours_year + "<br /> "
          + "<strong>Cost per Year: </strong>" +" "+"$"+ e.features[0].properties.cost_year + "<br /> "
          + '<strong><a href="' + e.features[0].properties.url + ' + "target="_blank""" >' + "REMIX Link" + '</a></strong>')
        .addTo(map);
        // listingEl.appendChild(item);

     });

//********* Popups for Riverdale Phase 2 Lines Layer ******

    map.on('click', 'Riverdale BRT Phase 2', function(e) {
        new mapboxgl.Popup()
        .setLngLat(e.lngLat)
        .setHTML(
        "<h2>RIVERDALE BRT PHASE 2</h2>" + "<hr />"
        + "<strong>Line Name: </strong>"+ " " + e.features[0].properties.line_name + "<br />"
        + "<strong>Miles: </strong>" + e.features[0].properties.mi + "<br /> "
        + "<strong>Hours per Year: </strong>" + e.features[0].properties.hours_year + "<br /> "
        + "<strong>Cost per Year: </strong>" +" "+"$"+ e.features[0].properties.cost_year + "<br /> "
        + '<strong><a href="' + e.features[0].properties.url + ' + "target="_blank""" >' + "REMIX Link" + '</a></strong>')
        .addTo(map);
        // listingEl.appendChild(item);
      });

//********* Popups for Existing Clayton Bus Routes Layer ******

    map.on('click', 'Existing Clayton Bus Routes', function(e) {
        new mapboxgl.Popup()
        .setLngLat(e.lngLat)
        .setHTML(
        "<strong>Existing Clayton Bus Route </strong>"+ "<hr />"
        +"<strong>Route Number: </strong>"+ " " + e.features[0].properties.Route_Num + "<br />")
        .addTo(map);
        // listingEl.appendChild(item);
      });

//********* Popups Clayton Commuter Rail Layer ******

    map.on('click', 'Clayton Commuter Rail', function(e) {
        new mapboxgl.Popup()
        .setLngLat(e.lngLat)
        .setHTML(
        "<strong>Commuter Rail</strong>" )
        .addTo(map);
        // listingEl.appendChild(item);
      });



  </script>

</body>

</html>
